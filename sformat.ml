(* camlp4r *)
(* This file has been generated by program: do not edit! *)
(* Copyright (c) INRIA 2007 *)

exception GiveUp;;

let line_length = ref 77;;
let horiz_ctx = ref false;;

let after_print s =
  if !horiz_ctx then
    if String.contains s '\n' || String.length s > !line_length then
      raise GiveUp
    else s
  else s
;;

let sprintf fmt = Printf.ksprintf after_print fmt;;

let call_with r v f a =
  let saved = !r in
  try r := v; let b = f a in r := saved; b with
    e -> r := saved; raise e
;;

let give_up () = raise GiveUp;;

let horiz_vertic horiz vertic =
  try call_with horiz_ctx true horiz give_up with
    GiveUp -> if !horiz_ctx then raise GiveUp else vertic ()
;;
